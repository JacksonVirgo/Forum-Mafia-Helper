(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{27:function(t,e,n){t.exports={centerModal:"centermodal_centerModal__2Mx-M",menuoption:"centermodal_menuoption__jLOr8",modalForm:"centermodal_modalForm__2Ok44",modalLabel:"centermodal_modalLabel__UgZm8",modalInput:"centermodal_modalInput__1_gAg",modalTextarea:"centermodal_modalTextarea__1Hu6j",modalSubmit:"centermodal_modalSubmit__13Ld1",small:"centermodal_small__1SQYX"}},58:function(t,e,n){},96:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n(7),s=n(8),o=n(15),c=n(14),i=n(1),l=n.n(i),u=n(50),h=n.n(u),d=n(51),v=n(2),b=(n(58),n.p+"static/media/logo.f16fac0d.png"),m=n(27),g=n.n(m);function j(t){return Object(a.jsxs)("div",{className:g.a.centerModal,children:[Object(a.jsx)("img",{src:b,alt:"Logo"}),Object(a.jsx)("h1",{children:"Mafia Engine"}),(e="Version Beta 1.2",e?Object(a.jsx)("h2",{children:e}):null),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{className:"mainmenu",children:[Object(a.jsx)("a",{className:g.a.menuoption,href:"/replacement",children:"Replacement Form"}),Object(a.jsx)("a",{className:g.a.menuoption,href:"/votecount",children:"Vote Counter"})]})]});var e}function p(){return Object(a.jsxs)("div",{className:"centerModal",children:[Object(a.jsx)("img",{src:b,alt:"Logo"}),Object(a.jsx)("h1",{children:"404"}),Object(a.jsx)("h2",{children:"Page Not Found"})]})}var f=n(24),O=n(25),x=n.n(O),y="http://mafiaengine.com";var k=["January","February","March","April","May","June","July","August","September","October","November","December"];var S=function(t){var e=t.title,n=t.children;return Object(a.jsxs)("div",{className:"modalMain",children:[Object(a.jsx)("h1",{children:e}),n.map((function(t,e){return t}))]})},_=function(t){var e=t.child;return Object(a.jsx)("div",{className:"field",children:e})},M=function(t){var e=t.name,n=t.label;t.type;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("label",{htmlFor:e,children:n}),Object(a.jsx)("input",{id:t.name,type:t.type})]})},R=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).onSubmit=t.onSubmit,a.children=t.children,a.submitText=t.submitText,a}return Object(s.a)(n,[{key:"render",value:function(){return Object(a.jsxs)("form",{className:"modalForm",onSubmit:this.onSubmit,children:[this.children.map((function(t,e){return Object(a.jsx)(_,{child:Object(a.jsx)(M,{name:t.name,label:t.label,type:t.type})},t.name)})),Object(a.jsx)("input",{type:"submit",value:this.submitText})]})}}]),n}(l.a.Component),V=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(){var t;return Object(r.a)(this,n),(t=e.call(this)).onReplacement=function(e){var n=e.author,a=e.lastPage,r=e.title,s=e.url,o=function(){var t=new Date,e=t.getDate();e=function(t){var e=t%10,n=t%100;return 1===e&&11!==e?t+"st":2===e&&12!==n?t+"nd":3===e&&13!==n?t+"rd":t+"th"}(e);var n=t.getMonth()+1;return"".concat(e," ").concat(k[n-1])}(),c="".concat(o,"\n[i][url=").concat(s,"]").concat(r,"[/url][/i]\n[b]Moderator:[/b] [user]").concat(n,"[/user][tab]3[/tab][tab]3[/tab][b]Status:[/b] ").concat(a," pages [tab]3[/tab] [b]Replacing:[/b] [user]").concat(t.departing,"[/user]");t.setState({result:c,progress:""})},t.state={result:"",progress:""},t.departing=null,t.socket=x()(y),t.socket.on("replacement",t.onReplacement.bind(Object(f.a)(t))),t}return Object(s.a)(n,[{key:"onSubmit",value:function(t){t.preventDefault();var e=t.target.url.value;this.departing=t.target.departing.value,this.socket.emit("replacement",{url:e}),this.setState({progress:"[pending]",result:"Pending..."})}},{key:"render",value:function(){return Object(a.jsx)(S,{title:"Replacement Form",children:[Object(a.jsx)(R,{onSubmit:this.onSubmit.bind(this),submitText:"Generate",children:[{name:"url",label:"Game URL",type:"text"},{name:"departing",label:"Departing Player",type:"text"}]},"replacementForm"),Object(a.jsxs)("div",{className:"modalResult",children:[Object(a.jsxs)("h3",{children:["Result ",Object(a.jsx)("span",{children:this.state.progress})]}),Object(a.jsx)("textarea",{value:this.state.result,readOnly:!0})]},"result")]})}}]),n}(l.a.Component),w=n(26);var C=n(19),N=function(){function t(e,n){Object(r.a)(this,t),this.category=n,this.author=e.author,this.pronoun=e.pronoun,this.number=parseInt(e.post.number),this.url=e.post.url,this.votes=e.votes,this.vote={last:null,valid:null}}return Object(s.a)(t,[{key:"isAfter",value:function(t){return this.number>t.number}},{key:"getNewest",value:function(t){return t?this.isAfter?this:t:this}},{key:"clean",value:function(t){for(var e=t.totalnames,n=t.alias,a=this.votes[this.category],r=void 0,s=void 0,o=a.length;o>=0;o-=1){var c=a[o];if(void 0===r&&(r=c),void 0===s&&(c||null===c))if(null===c)s=null;else{var i=Object(C.findBestMatch)(c,e).bestMatch;i.rating,null===t||void 0===t||t.correctionWeight;var l=n[i.target];l&&(s=l,r===c&&(r=s))}}this.vote.last=r,this.vote.valid=s}},{key:"isValid",value:function(t){var e,n=this.number>parseInt(t.days[t.days.length-1]),a=!1,r=Object(w.a)(t.dead);try{for(r.s();!(e=r.n()).done;){var s=e.value,o=this.rootUser(s,t.totalnames),c=this.rootUser(this.author,t.totalnames);o.target===c.target&&(a=!0)}}catch(i){r.e(i)}finally{r.f()}return n&&!a}},{key:"rootUser",value:function(t,e){return Object(C.findBestMatch)(t,e).bestMatch}}]),t}();function F(t){for(var e=1;e<t.lemgth;e++)for(var n=e-1;n>-1;n--){if(t[e].length<t[n].length){var a=[t[n],t[n+1]];t[n+1]=a[0],t[n]=a[1]}}return t}var P=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(){var t;for(var a in Object(r.a)(this,n),(t=e.call(this)).state={progress:"",result:""},t.toggle={onlyCountVotes:!1},t.cache={},t.socket=null,t.toggle)t.state[a]=t.toggle[a];return t}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.startSocketConnection(),this.setupSocketListeners()}},{key:"componentWillUnmount",value:function(){this.closeSocketConnection()}},{key:"startSocketConnection",value:function(){this.socket=x.a.connect()}},{key:"closeSocketConnection",value:function(){this.socket.disconnect()}},{key:"setupSocketListeners",value:function(){this.socket.on("result",this.processVotes.bind(this)),this.socket.on("progress",this.processProgress.bind(this)),this.socket.on("error",this.processError.bind(this))}},{key:"processVotes",value:function(t){this.cache=Object.assign(this.cache,t);var e=this.clean();if(e){var n=this.format(e);this.setState({progress:"",result:n})}else this.setState({progress:"[ERROR]",result:"Thread is not compatible with this tool."})}},{key:"processProgress",value:function(t){var e=t.currentPage,n=t.lastPage,a=t.notes;e&&n&&this.setState({progress:"[".concat(Math.round(t.currentPage/t.lastPage*100),"%]")}),a&&this.setState({result:"".concat(a)})}},{key:"processError",value:function(t){this.setState({progress:"[ERROR]",result:t.type})}},{key:"onFormSubmit",value:function(t){t.preventDefault();var e=t.target.url.value;this.socket.emit("votecount",{url:e}),this.setState({progress:"[0%]",result:"Pending Result..."})}},{key:"onAddField",value:function(t){console.log(t)}},{key:"render",value:function(){return Object(a.jsx)(S,{title:"Vote Counter",children:[Object(a.jsx)(R,{onSubmit:this.onFormSubmit.bind(this),submitText:"Generate Vote Count",children:[{name:"url",label:"Game URL",type:"text"}]},"votecountForm"),Object(a.jsxs)("div",{className:"modalResult",children:[Object(a.jsxs)("h3",{children:["Result ",Object(a.jsx)("span",{children:this.state.progress})]}),Object(a.jsx)("textarea",{value:this.state.result,readOnly:!0})]},"result")]})}},{key:"clean",value:function(){var t={votes:{},wagons:{},notVoting:[],majority:null};if(this.cache.settings.players.length>=1)for(var e in this.cache.voteCount){t.votes[e]||(t.votes[e]={}),t.wagons[e]||(t.wagons[e]={});for(var n in t.notVoting=this.getAlive(),t.majority=Math.ceil(t.notVoting.length/2),this.cache.voteCount[e]){for(var a,r=this.cache.voteCount[e][n],s=null,o=null,c=0;c<r.length;c++){var i=new N(r[c],e);i.clean(this.cache.settings),void 0!==i.vote.valid&&(o=i.vote.valid?i.getNewest(o):null),s=i.getNewest(s)}if(null===(a=o)||void 0===a?void 0:a.isValid(this.cache.settings)){var l=t.notVoting.indexOf(o.author);t.notVoting.splice(l,1),t.votes[e][n]={last:s,valid:o},t.wagons[e][o.vote.valid]||(t.wagons[e][o.vote.valid]=[]);var u=t.wagons[e][o.vote.valid];u.push(o),u=F(u),t.wagons[e][o.vote.valid]=u}}}return this.cache.settings.players.length>=1?t:null}},{key:"format",value:function(t){var e=t.wagons,n=t.notVoting,a=(t.majority,"");for(var r in e){var s="[area=VC]";for(var o in e[r]){for(var c=e[r][o],i="[b]".concat(o,"[/b] (").concat(c.length,") -> "),l=0;l<c.length;l++)l>0&&(i+=", "),i+="".concat(c[l].author);s+=i+"\n"}if(n.length>0){s+="\n[b]Not Voting[/b] (".concat(n.length,") -> ");for(var u=0;u<n.length;u++)u>0&&(s+=", "),s+="".concat(n[u])}a+=s+="".concat(this.cache.settings.deadline?"\nDay ends in [countdown]".concat(this.cache.settings.deadline,"[/countdown]"):"","[/area]")}return a}},{key:"getAlive",value:function(){for(var t=this.cache.settings,e=t.players,n=t.dead,a=[],r=0;r<e.length;r++){var s=this.getRootAuthor(e[r]);U(s,a)||U(s,n)||a.push(s)}return a}},{key:"checkValid",value:function(t,e){var n,a=t.number>parseInt(this.cache.settings.days[this.cache.settings.days.length-1]),r=!1,s=Object(w.a)(this.cache.settings.dead);try{for(s.s();!(n=s.n()).done;){var o=n.value,c=this.rootUser(o),i=this.rootUser(t.author);c.target===i.target&&(r=!0)}}catch(l){s.e(l)}finally{s.f()}return a&&!r}},{key:"isValidVote",value:function(t){var e=!1;if(t){var n=this.rootUser(t);n.rating,this.cache.settings.correctionWeight,this.cache.settings.alias[n.target]&&(e=!0)}return e}},{key:"rootUser",value:function(t){return Object(C.findBestMatch)(t,this.cache.settings.totalnames).bestMatch}},{key:"getRootAuthor",value:function(t){var e=Object(C.findBestMatch)(t,this.cache.settings.totalnames).bestMatch;return this.cache.settings.alias[e.target]||e.target}}]),n}(l.a.Component);function U(t,e){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}var A=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={},a}return Object(s.a)(n,[{key:"render",value:function(){return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(d.a,{children:Object(a.jsxs)(v.d,{children:[Object(a.jsx)(v.b,{exact:!0,path:"/",component:j}),Object(a.jsx)(v.b,{exact:!0,path:"/replacement",component:V}),Object(a.jsx)(v.b,{exact:!0,path:"/votecount",component:P}),Object(a.jsx)(v.b,{exact:!0,path:"/test",component:P}),Object(a.jsx)(v.b,{path:"/404",component:p}),Object(a.jsx)(v.a,{to:"/404"})]})})})}}]),n}(l.a.Component);h.a.render(Object(a.jsx)(A,{}),document.getElementById("root"))}},[[96,1,2]]]);
//# sourceMappingURL=main.5eb7705b.chunk.js.map